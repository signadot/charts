# This file is generated. Do not edit.
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.6.2
    {{- range $key, $val := .Values.commonAnnotations }}
    {{ $key | quote }}: {{ $val | quote }}
    {{- end }}
  labels:
    {{- range $key, $val := .Values.commonLabels }}
    {{ $key | quote }}: {{ $val | quote }}
    {{- end }}
  name: signadotsandboxes.signadot.com
spec:
  group: signadot.com
  names:
    kind: SignadotSandbox
    listKind: SignadotSandboxList
    plural: signadotsandboxes
    shortNames:
    - sds
    singular: signadotsandbox
  scope: Cluster
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        description: SignadotSandbox can be used to create a sandbox in which customized
          versions of one or more workloads (e.g. running work-in-progress code) run
          alongside the real workloads and serve only those requests that are explicitly
          tagged to run in this sandbox.
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: SignadotSandboxSpec defines the desired state of SignadotSandbox
            properties:
              clusterName:
                description: ClusterName should be the name of the cluster this sandbox
                  lives in.
                type: string
              customization:
                description: Customization describes the ways in which live workloads
                  running in the cluster should be customized for this sandbox.
                properties:
                  images:
                    description: "Images to replace when cloning workloads (e.g. Deployments)
                      for this sandbox. \n Any live Deployment (one that isn't part
                      of a sandbox) that uses an image from this list will be cloned
                      and the clone will use the new image name and/or tag specified."
                    items:
                      description: ImageReplacement describes a rule for replacing
                        images in cloned containers.
                      properties:
                        name:
                          description: "Name specifies which image name in live workloads
                            will be replaced. \n Example: us.gcr.io/my-staging-registry/widget"
                          type: string
                        namespace:
                          description: Namespace optionally specifies which namespace
                            will be searched.
                          type: string
                        newName:
                          description: "NewName provides a replacement for the image
                            name (the part before the tag). If this is left unset,
                            the image name will not be changed. \n Example: us.gcr.io/my-dev-registry/username/widget"
                          type: string
                        newTag:
                          description: "NewTag provides a replacement tag for the
                            image. If this is left unset, the image tag will not be
                            changed. \n Example: v1.0.0-snapshot-abc123"
                          type: string
                      required:
                      - name
                      type: object
                    type: array
                  patches:
                    description: "Patches to apply when cloning workloads (e.g. Deployments)
                      for this sandbox. \n Each patch describes which object it applies
                      to. If a matching object is found, a clone of that object will
                      be created for this sandbox and the patch will be applied to
                      the clone. \n If multiple patches and/or image replacement rules
                      match a given object, only one clone of that object will be
                      created, and then all matching patches and image replacements
                      will be applied on top of one another to the clone. Patches
                      will be applied last, in the order listed here, so they take
                      precedence over image replacements. \n Each patch can be defined
                      in any one of the formats supported by `kubectl patch`. See:
                      https://kubernetes.io/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/
                      \n Only one of the following fields should be set for each patch
                      in the list: \n   strategic - Define the patch in Kubernetes
                      strategic merge patch format.   merge - Define the patch in
                      JSON Merge Patch format (RFC 7386).   json - Define the patch
                      in JSON Patch format (RFC 6902)."
                    items:
                      description: Patch describes a set of changes to apply to a
                        given object.
                      properties:
                        json:
                          description: JSON specifies the patch in JSON Patch format
                            (RFC 6902).
                          items:
                            description: "RawExtension is a wrapper around runtime.RawExtension.
                              \n It exists so we can add the PreserveUnknownFields
                              directive on the items in a []RawExtension list, rather
                              than to the list itself. Adding PreserveUnknownFields
                              to the list itself works in the latest patch releases
                              of k8s v1.18+, but the fix was never backported to v1.17
                              or older: \n https://github.com/kubernetes/kubernetes/pull/94888"
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          type: array
                        merge:
                          description: Merge specifies the patch in JSON Merge Patch
                            format (RFC 7396).
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        strategic:
                          description: "Strategic specifies the patch in Kubernetes
                            strategic merge patch format. \n See: https://kubernetes.io/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/"
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        target:
                          description: Target specifies what object this patch applies
                            to.
                          properties:
                            apiVersion:
                              description: APIVersion specifies the API Version (e.g.
                                "apps/v1") of the object to patch.
                              type: string
                            kind:
                              description: Kind specifies the Kind (e.g. "Deployment")
                                of the object to patch.
                              type: string
                            name:
                              description: Name specifies the name of the object to
                                patch.
                              type: string
                            namespace:
                              description: Namespace optionally specifies which namespace
                                will be searched.
                              type: string
                          required:
                          - apiVersion
                          - kind
                          - name
                          type: object
                        template:
                          description: "Template specifies whether to treat the patch
                            content as a template. If enabled, variable substitution
                            will be performed, allowing patches to refer to information
                            that will only become available after the operator processes
                            a sandbox spec, such as the names of SignadotResource
                            plugin output objects. \n Default: false"
                          type: boolean
                      required:
                      - target
                      type: object
                    type: array
                  preservedLabels:
                    description: "PreservedLabels is a list of RE2 regular expressions
                      to check against label keys on the original baseline Pod template.
                      The expression can match any substring within the key, so use
                      anchors if you want to require a full match. \n Normally, all
                      baseline labels are stripped from the cloned Pod template to
                      ensure it can't match any existing Services. Labels from the
                      baseline Pod that match any of these regular expressions will
                      be preserved on the cloned Pod instead. \n If preserving these
                      labels would cause the cloned Pods to match a baseline Service,
                      the sandbox controller will pause and report an error to avoid
                      interference."
                    items:
                      type: string
                    type: array
                type: object
              id:
                description: "ID should be a unique identifier for the sandbox. \n
                  It can be up to 32 characters, consisting of lowercase alphanumeric
                  characters or '-', but it must both start and end with an alphanumeric
                  character."
                maxLength: 32
                minLength: 1
                pattern: ^[a-z0-9]([a-z0-9-]*[a-z0-9])?$
                type: string
              name:
                description: "Name should be a unique value in the organization that
                  easily allows any user to identify what the sandbox is being used
                  for when reading it. \n It can be up to 30 characters, consisting
                  of alphanumeric characters or '-', but it must both start and end
                  with an alphanumeric character."
                maxLength: 30
                pattern: ^$|^[a-zA-Z]([a-zA-Z0-9-]*[a-zA-Z0-9])?$
                type: string
              resources:
                description: Resources describes a set of requests for required resources
                  for this sandbox to run.
                items:
                  properties:
                    name:
                      description: "Name is the name of the resource as referred to
                        by the requestor. \n The name must start with a letter and
                        contain only alphanumeric characters so that it can be a template
                        variable name."
                      maxLength: 20
                      minLength: 1
                      pattern: ^[A-Za-z][A-Za-z0-9]*$
                      type: string
                    outputKind:
                      default: Secret
                      description: OutputKind is the kind of object (ConfigMap or
                        Secret) in which the plugin provisioner's output should be
                        stored. The default is "Secret".
                      enum:
                      - Secret
                      - ConfigMap
                      type: string
                    params:
                      additionalProperties:
                        type: string
                      description: Params is a map of unstructured key-value pairs
                        which will be provided to the Provisioner.
                      type: object
                    pluginName:
                      description: PluginName is the name of the plugin which will
                        provision and deprovision the resource.
                      type: string
                  required:
                  - name
                  - pluginName
                  type: object
                type: array
            required:
            - id
            type: object
          status:
            description: SignadotSandboxStatus defines the observed state of SignadotSandbox
            properties:
              conditions:
                description: 'Conditions is a list of conditions that matches the
                  conventions expected by kubectl, allowing our CRDs to work with:
                  kubectl wait --for=condition=...'
                items:
                  description: "StatusCondition is a condition struct that matches
                    the conventions expected by kubectl, allowing our CRDs to work
                    with: kubectl wait --for=condition=... \n StatusConditions must
                    follow the following discipline in reconciliation: The operator
                    MUST always populate all the condition types in a SignadotSandboxStatus
                    struct, irrespective of whether the condition is known or not
                    (see corev1.ConditionUnknown) so that access via a k8s client
                    can determine whether the capability is supported in the operator."
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              customizedDeployments:
                description: CustomizedDeployments is the number of Deployments that
                  have been cloned and customized.
                format: int32
                type: integer
              observedGeneration:
                format: int64
                type: integer
              readyDeployments:
                description: ReadyDeployments is the number of cloned Deployments
                  that have been customized and are Complete.
                format: int32
                type: integer
              readyResources:
                description: ReadyResources is the number of resources which have
                  been provided by a Plugin.
                format: int32
                type: integer
              resources:
                description: Resources is the total number of resources requested.
                format: int32
                type: integer
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
