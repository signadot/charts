{{- if and (hasKey .Values "agent") (hasKey .Values.agent "clusterToken")
}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ with .Values }}{{ with .agent }}{{ with .tokenSecret }}{{ . }}{{- else -}}"cluster-agent"{{- end }}{{- else -}}"cluster-agent"{{- end }}{{- else -}}"cluster-agent"{{- end }}
  namespace: signadot
data:
  token: {{ .Values.agent.clusterToken | b64enc | quote }}
{{- end }}
